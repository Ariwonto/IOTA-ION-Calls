<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <title>ION Call</title>
    <script>
    (function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.adapter=e()}})(function(){var t,r,n;return function e(o,c,d){function s(r,t){if(!c[r]){if(!o[r]){var n=typeof require=="function"&&require;if(!t&&n)return n(r,!0);if(p)return p(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var a=c[r]={exports:{}};o[r][0].call(a.exports,function(e){var t=o[r][1][e];return s(t?t:e)},a,a.exports,e,o,c,d)}return c[r].exports}var p=typeof require=="function"&&require;for(var t=0;t<d.length;t++)s(d[t]);return s}({1:[function(e,t,r){"use strict";var j=e("sdp");function fixStatsType(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function writeMediaSection(e,t,r,n,i){var a=j.writeRtpDescription(e.kind,t);a+=j.writeIceParameters(e.iceGatherer.getLocalParameters());a+=j.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":i||"active");a+="a=mid:"+e.mid+"\r\n";if(e.rtpSender&&e.rtpReceiver){a+="a=sendrecv\r\n"}else if(e.rtpSender){a+="a=sendonly\r\n"}else if(e.rtpReceiver){a+="a=recvonly\r\n"}else{a+="a=inactive\r\n"}if(e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(n?n.id:"-")+" "+o+"\r\n";a+="a="+s;a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s;if(e.sendEncodingParameters[0].rtx){a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s;a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+j.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+j.localCName+"\r\n"}return a}function filterIceServers(e,n){var i=false;e=JSON.parse(JSON.stringify(e));return e.filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;if(e.url&&!e.urls){console.warn("RTCIceServer.url is deprecated! Use urls instead.")}var r=typeof t==="string";if(r){t=[t]}t=t.filter(function(e){var t=e.indexOf("turn:")===0&&e.indexOf("transport=udp")!==-1&&e.indexOf("turn:[")===-1&&!i;if(t){i=true;return true}return e.indexOf("stun:")===0&&n>=14393&&e.indexOf("?transport=udp")===-1});delete e.url;e.urls=r?t[0]:t;return!!t.length}})}function getCommonCapabilities(n,i){var a={codecs:[],headerExtensions:[],fecMechanisms:[]};var o=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++){if(t[r].payloadType===e||t[r].preferredPayloadType===e){return t[r]}}};var s=function(e,t,r,n){var i=o(e.parameters.apt,r);var a=o(t.parameters.apt,n);return i&&a&&i.name.toLowerCase()===a.name.toLowerCase()};n.codecs.forEach(function(r){for(var e=0;e<i.codecs.length;e++){var t=i.codecs[e];if(r.name.toLowerCase()===t.name.toLowerCase()&&r.clockRate===t.clockRate){if(r.name.toLowerCase()==="rtx"&&r.parameters&&t.parameters.apt){if(!s(r,t,n.codecs,i.codecs)){continue}}t=JSON.parse(JSON.stringify(t));t.numChannels=Math.min(r.numChannels,t.numChannels);a.codecs.push(t);t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++){if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter){return true}}return false});break}}});n.headerExtensions.forEach(function(e){for(var t=0;t<i.headerExtensions.length;t++){var r=i.headerExtensions[t];if(e.uri===r.uri){a.headerExtensions.push(r);break}}});return a}function isActionAllowedInSignalingState(e,t,r){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)!==-1}function maybeAddCandidate(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});if(!r){e.addRemoteCandidate(t)}return!r}function makeError(e,t){var r=new Error(t);r.name=e;r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:undefined,OperationError:undefined}[e];return r}t.exports=function(I,L){function addTrackToStreamAndFireEvent(e,t){t.addTrack(e);t.dispatchEvent(new I.MediaStreamTrackEvent("addtrack",{track:e}))}function removeTrackFromStreamAndFireEvent(e,t){t.removeTrack(e);t.dispatchEvent(new I.MediaStreamTrackEvent("removetrack",{track:e}))}function fireAddTrack(e,t,r,n){var i=new Event("track");i.track=t;i.receiver=r;i.transceiver={receiver:r};i.streams=n;I.setTimeout(function(){e._dispatchEvent("track",i)})}var n=function(e){var t=this;var r=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=r[e].bind(r)});this.canTrickleIceCandidates=null;this.needNegotiation=false;this.localStreams=[];this.remoteStreams=[];this._localDescription=null;this._remoteDescription=null;this.signalingState="stable";this.iceConnectionState="new";this.connectionState="new";this.iceGatheringState="new";e=JSON.parse(JSON.stringify(e||{}));this.usingBundle=e.bundlePolicy==="max-bundle";if(e.rtcpMuxPolicy==="negotiate"){throw makeError("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported")}else if(!e.rtcpMuxPolicy){e.rtcpMuxPolicy="require"}switch(e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all";break}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced";break}e.iceServers=filterIceServers(e.iceServers||[],L);this._iceGatherers=[];if(e.iceCandidatePoolSize){for(var n=e.iceCandidatePoolSize;n>0;n--){this._iceGatherers.push(new I.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}))}}else{e.iceCandidatePoolSize=0}this._config=e;this.transceivers=[];this._sdpSessionId=j.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=undefined;this._isClosed=false};Object.defineProperty(n.prototype,"localDescription",{configurable:true,get:function(){return this._localDescription}});Object.defineProperty(n.prototype,"remoteDescription",{configurable:true,get:function(){return this._remoteDescription}});n.prototype.onicecandidate=null;n.prototype.onaddstream=null;n.prototype.ontrack=null;n.prototype.onremovestream=null;n.prototype.onsignalingstatechange=null;n.prototype.oniceconnectionstatechange=null;n.prototype.onconnectionstatechange=null;n.prototype.onicegatheringstatechange=null;n.prototype.onnegotiationneeded=null;n.prototype.ondatachannel=null;n.prototype._dispatchEvent=function(e,t){if(this._isClosed){return}this.dispatchEvent(t);if(typeof this["on"+e]==="function"){this["on"+e](t)}};n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)};n.prototype.getConfiguration=function(){return this._config};n.prototype.getLocalStreams=function(){return this.localStreams};n.prototype.getRemoteStreams=function(){return this.remoteStreams};n.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0;var n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:true};if(this.usingBundle&&r){n.iceTransport=this.transceivers[0].iceTransport;n.dtlsTransport=this.transceivers[0].dtlsTransport}else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport;n.dtlsTransport=i.dtlsTransport}if(!t){this.transceivers.push(n)}return n};n.prototype.addTrack=function(t,e){if(this._isClosed){throw makeError("InvalidStateError","Attempted to call addTrack on a closed peerconnection.")}var r=this.transceivers.find(function(e){return e.track===t});if(r){throw makeError("InvalidAccessError","Track already exists.")}var n;for(var i=0;i<this.transceivers.length;i++){if(!this.transceivers[i].track&&this.transceivers[i].kind===t.kind){n=this.transceivers[i]}}if(!n){n=this._createTransceiver(t.kind)}this._maybeFireNegotiationNeeded();if(this.localStreams.indexOf(e)===-1){this.localStreams.push(e)}n.track=t;n.stream=e;n.rtpSender=new I.RTCRtpSender(t,n.dtlsTransport);return n.rtpSender};n.prototype.addStream=function(t){var r=this;if(L>=15025){t.getTracks().forEach(function(e){r.addTrack(e,t)})}else{var n=t.clone();t.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})});n.getTracks().forEach(function(e){r.addTrack(e,n)})}};n.prototype.removeTrack=function(t){if(this._isClosed){throw makeError("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.")}if(!(t instanceof I.RTCRtpSender)){throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack "+"does not implement interface RTCRtpSender.")}var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e){throw makeError("InvalidAccessError","Sender was not created by this connection.")}var r=e.stream;e.rtpSender.stop();e.rtpSender=null;e.track=null;e.stream=null;var n=this.transceivers.map(function(e){return e.stream});if(n.indexOf(r)===-1&&this.localStreams.indexOf(r)>-1){this.localStreams.splice(this.localStreams.indexOf(r),1)}this._maybeFireNegotiationNeeded()};n.prototype.removeStream=function(e){var r=this;e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});if(e){r.removeTrack(e)}})};n.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})};n.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})};n.prototype._createIceGatherer=function(r,e){var n=this;if(e&&r>0){return this.transceivers[0].iceGatherer}else if(this._iceGatherers.length){return this._iceGatherers.shift()}var i=new I.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(i,"state",{value:"new",writable:true});this.transceivers[r].bufferedCandidateEvents=[];this.transceivers[r].bufferCandidates=function(e){var t=!e.candidate||Object.keys(e.candidate).length===0;i.state=t?"completed":"gathering";if(n.transceivers[r].bufferedCandidateEvents!==null){n.transceivers[r].bufferedCandidateEvents.push(e)}};i.addEventListener("localcandidate",this.transceivers[r].bufferCandidates);return i};n.prototype._gather=function(s,c){var d=this;var p=this.transceivers[c].iceGatherer;if(p.onlocalcandidate){return}var e=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null;p.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates);p.onlocalcandidate=function(e){if(d.usingBundle&&c>0){return}var t=new Event("icecandidate");t.candidate={sdpMid:s,sdpMLineIndex:c};var r=e.candidate;var n=!r||Object.keys(r).length===0;if(n){if(p.state==="new"||p.state==="gathering"){p.state="completed"}}else{if(p.state==="new"){p.state="gathering"}r.component=1;r.ufrag=p.getLocalParameters().usernameFragment;var i=j.writeCandidate(r);t.candidate=Object.assign(t.candidate,j.parseCandidate(i));t.candidate.candidate=i;t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}}var a=j.getMediaSections(d._localDescription.sdp);if(!n){a[t.candidate.sdpMLineIndex]+="a="+t.candidate.candidate+"\r\n"}else{a[t.candidate.sdpMLineIndex]+="a=end-of-candidates\r\n"}d._localDescription.sdp=j.getDescription(d._localDescription.sdp)+a.join("");var o=d.transceivers.every(function(e){return e.iceGatherer&&e.iceGatherer.state==="completed"});if(d.iceGatheringState!=="gathering"){d.iceGatheringState="gathering";d._emitGatheringStateChange()}if(!n){d._dispatchEvent("icecandidate",t)}if(o){d._dispatchEvent("icecandidate",new Event("icecandidate"));d.iceGatheringState="complete";d._emitGatheringStateChange()}};I.setTimeout(function(){e.forEach(function(e){p.onlocalcandidate(e)})},0)};n.prototype._createIceAndDtlsTransports=function(){var e=this;var t=new I.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState();e._updateConnectionState()};var r=new I.RTCDtlsTransport(t);r.ondtlsstatechange=function(){e._updateConnectionState()};r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:true});e._updateConnectionState()};return{iceTransport:t,dtlsTransport:r}};n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;if(t){delete t.onlocalcandidate;delete this.transceivers[e].iceGatherer}var r=this.transceivers[e].iceTransport;if(r){delete r.onicestatechange;delete this.transceivers[e].iceTransport}var n=this.transceivers[e].dtlsTransport;if(n){delete n.ondtlsstatechange;delete n.onerror;delete this.transceivers[e].dtlsTransport}};n.prototype._transceive=function(e,t,r){var n=getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);if(t&&e.rtpSender){n.encodings=e.sendEncodingParameters;n.rtcp={cname:j.localCName,compound:e.rtcpParameters.compound};if(e.recvEncodingParameters.length){n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc}e.rtpSender.send(n)}if(r&&e.rtpReceiver&&n.codecs.length>0){if(e.kind==="video"&&e.recvEncodingParameters&&L<15019){e.recvEncodingParameters.forEach(function(e){delete e.rtx})}if(e.recvEncodingParameters.length){n.encodings=e.recvEncodingParameters}else{n.encodings=[{}]}n.rtcp={compound:e.rtcpParameters.compound};if(e.rtcpParameters.cname){n.rtcp.cname=e.rtcpParameters.cname}if(e.sendEncodingParameters.length){n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc}e.rtpReceiver.receive(n)}};n.prototype.setLocalDescription=function(e){var u=this;if(["offer","answer"].indexOf(e.type)===-1){return Promise.reject(makeError("TypeError",'Unsupported type "'+e.type+'"'))}if(!isActionAllowedInSignalingState("setLocalDescription",e.type,u.signalingState)||u._isClosed){return Promise.reject(makeError("InvalidStateError","Can not set local "+e.type+" in state "+u.signalingState))}var t;var l;if(e.type==="offer"){t=j.splitSections(e.sdp);l=t.shift();t.forEach(function(e,t){var r=j.parseRtpParameters(e);u.transceivers[t].localCapabilities=r});u.transceivers.forEach(function(e,t){u._gather(e.mid,t)})}else if(e.type==="answer"){t=j.splitSections(u._remoteDescription.sdp);l=t.shift();var v=j.matchPrefix(l,"a=ice-lite").length>0;t.forEach(function(e,t){var r=u.transceivers[t];var n=r.iceGatherer;var i=r.iceTransport;var a=r.dtlsTransport;var o=r.localCapabilities;var s=r.remoteCapabilities;var c=j.isRejected(e)&&j.matchPrefix(e,"a=bundle-only").length===0;if(!c&&!r.rejected){var d=j.getIceParameters(e,l);var p=j.getDtlsParameters(e,l);if(v){p.role="server"}if(!u.usingBundle||t===0){u._gather(r.mid,t);if(i.state==="new"){i.start(n,d,v?"controlling":"controlled")}if(a.state==="new"){a.start(p)}}var f=getCommonCapabilities(o,s);u._transceive(r,f.codecs.length>0,false)}})}u._localDescription={type:e.type,sdp:e.sdp};if(e.type==="offer"){u._updateSignalingState("have-local-offer")}else{u._updateSignalingState("stable")}return Promise.resolve()};n.prototype.setRemoteDescription=function(k){var w=this;if(["offer","answer"].indexOf(k.type)===-1){return Promise.reject(makeError("TypeError",'Unsupported type "'+k.type+'"'))}if(!isActionAllowedInSignalingState("setRemoteDescription",k.type,w.signalingState)||w._isClosed){return Promise.reject(makeError("InvalidStateError","Can not set remote "+k.type+" in state "+w.signalingState))}var _={};w.remoteStreams.forEach(function(e){_[e.id]=e});var x=[];var e=j.splitSections(k.sdp);var D=e.shift();var O=j.matchPrefix(D,"a=ice-lite").length>0;var M=j.matchPrefix(D,"a=group:BUNDLE ").length>0;w.usingBundle=M;var t=j.matchPrefix(D,"a=ice-options:")[0];if(t){w.canTrickleIceCandidates=t.substr(14).split(" ").indexOf("trickle")>=0}else{w.canTrickleIceCandidates=false}e.forEach(function(e,t){var r=j.splitLines(e);var n=j.getKind(e);var i=j.isRejected(e)&&j.matchPrefix(e,"a=bundle-only").length===0;var a=r[0].substr(2).split(" ")[2];var o=j.getDirection(e,D);var s=j.parseMsid(e);var c=j.getMid(e)||j.generateIdentifier();if(i||n==="application"&&(a==="DTLS/SCTP"||a==="UDP/DTLS/SCTP")){w.transceivers[t]={mid:c,kind:n,protocol:a,rejected:true};return}if(!i&&w.transceivers[t]&&w.transceivers[t].rejected){w.transceivers[t]=w._createTransceiver(n,true)}var d;var p;var f;var u;var l;var v;var m;var h;var g;var C=j.parseRtpParameters(e);var y;var T;if(!i){y=j.getIceParameters(e,D);T=j.getDtlsParameters(e,D);T.role="client"}m=j.parseRtpEncodingParameters(e);var S=j.parseRtcpParameters(e);var R=j.matchPrefix(e,"a=end-of-candidates",D).length>0;var P=j.matchPrefix(e,"a=candidate:").map(function(e){return j.parseCandidate(e)}).filter(function(e){return e.component===1});if((k.type==="offer"||k.type==="answer")&&!i&&M&&t>0&&w.transceivers[t]){w._disposeIceAndDtlsTransports(t);w.transceivers[t].iceGatherer=w.transceivers[0].iceGatherer;w.transceivers[t].iceTransport=w.transceivers[0].iceTransport;w.transceivers[t].dtlsTransport=w.transceivers[0].dtlsTransport;if(w.transceivers[t].rtpSender){w.transceivers[t].rtpSender.setTransport(w.transceivers[0].dtlsTransport)}if(w.transceivers[t].rtpReceiver){w.transceivers[t].rtpReceiver.setTransport(w.transceivers[0].dtlsTransport)}}if(k.type==="offer"&&!i){d=w.transceivers[t]||w._createTransceiver(n);d.mid=c;if(!d.iceGatherer){d.iceGatherer=w._createIceGatherer(t,M)}if(P.length&&d.iceTransport.state==="new"){if(R&&(!M||t===0)){d.iceTransport.setRemoteCandidates(P)}else{P.forEach(function(e){maybeAddCandidate(d.iceTransport,e)})}}h=I.RTCRtpReceiver.getCapabilities(n);if(L<15019){h.codecs=h.codecs.filter(function(e){return e.name!=="rtx"})}v=d.sendEncodingParameters||[{ssrc:(2*t+2)*1001}];var E=false;if(o==="sendrecv"||o==="sendonly"){E=!d.rtpReceiver;l=d.rtpReceiver||new I.RTCRtpReceiver(d.dtlsTransport,n);if(E){var b;g=l.track;if(s&&s.stream==="-"){}else if(s){if(!_[s.stream]){_[s.stream]=new I.MediaStream;Object.defineProperty(_[s.stream],"id",{get:function(){return s.stream}})}Object.defineProperty(g,"id",{get:function(){return s.track}});b=_[s.stream]}else{if(!_["default"]){_["default"]=new I.MediaStream}b=_["default"]}if(b){addTrackToStreamAndFireEvent(g,b);d.associatedRemoteMediaStreams.push(b)}x.push([g,l,b])}}else if(d.rtpReceiver&&d.rtpReceiver.track){d.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===d.rtpReceiver.track.id});if(t){removeTrackFromStreamAndFireEvent(t,e)}});d.associatedRemoteMediaStreams=[]}d.localCapabilities=h;d.remoteCapabilities=C;d.rtpReceiver=l;d.rtcpParameters=S;d.sendEncodingParameters=v;d.recvEncodingParameters=m;w._transceive(w.transceivers[t],false,E)}else if(k.type==="answer"&&!i){d=w.transceivers[t];p=d.iceGatherer;f=d.iceTransport;u=d.dtlsTransport;l=d.rtpReceiver;v=d.sendEncodingParameters;h=d.localCapabilities;w.transceivers[t].recvEncodingParameters=m;w.transceivers[t].remoteCapabilities=C;w.transceivers[t].rtcpParameters=S;if(P.length&&f.state==="new"){if((O||R)&&(!M||t===0)){f.setRemoteCandidates(P)}else{P.forEach(function(e){maybeAddCandidate(d.iceTransport,e)})}}if(!M||t===0){if(f.state==="new"){f.start(p,y,"controlling")}if(u.state==="new"){u.start(T)}}w._transceive(d,o==="sendrecv"||o==="recvonly",o==="sendrecv"||o==="sendonly");if(l&&(o==="sendrecv"||o==="sendonly")){g=l.track;if(s){if(!_[s.stream]){_[s.stream]=new I.MediaStream}addTrackToStreamAndFireEvent(g,_[s.stream]);x.push([g,l,_[s.stream]])}else{if(!_["default"]){_["default"]=new I.MediaStream}addTrackToStreamAndFireEvent(g,_["default"]);x.push([g,l,_["default"]])}}else{delete d.rtpReceiver}}});if(w._dtlsRole===undefined){w._dtlsRole=k.type==="offer"?"active":"passive"}w._remoteDescription={type:k.type,sdp:k.sdp};if(k.type==="offer"){w._updateSignalingState("have-remote-offer")}else{w._updateSignalingState("stable")}Object.keys(_).forEach(function(e){var n=_[e];if(n.getTracks().length){if(w.remoteStreams.indexOf(n)===-1){w.remoteStreams.push(n);var t=new Event("addstream");t.stream=n;I.setTimeout(function(){w._dispatchEvent("addstream",t)})}x.forEach(function(e){var t=e[0];var r=e[1];if(n.id!==e[2].id){return}fireAddTrack(w,t,r,[n])})}});x.forEach(function(e){if(e[2]){return}fireAddTrack(w,e[0],e[1],[])});I.setTimeout(function(){if(!(w&&w.transceivers)){return}w.transceivers.forEach(function(e){if(e.iceTransport&&e.iceTransport.state==="new"&&e.iceTransport.getRemoteCandidates().length>0){console.warn("Timeout for addRemoteCandidate. Consider sending "+"an end-of-candidates notification");e.iceTransport.addRemoteCandidate({})}})},4e3);return Promise.resolve()};n.prototype.close=function(){this.transceivers.forEach(function(e){if(e.iceTransport){e.iceTransport.stop()}if(e.dtlsTransport){e.dtlsTransport.stop()}if(e.rtpSender){e.rtpSender.stop()}if(e.rtpReceiver){e.rtpReceiver.stop()}});this._isClosed=true;this._updateSignalingState("closed")};n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)};n.prototype._maybeFireNegotiationNeeded=function(){var t=this;if(this.signalingState!=="stable"||this.needNegotiation===true){return}this.needNegotiation=true;I.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=false;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0)};n.prototype._updateIceConnectionState=function(){var e;var t={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){t[e.iceTransport.state]++});e="new";if(t.failed>0){e="failed"}else if(t.checking>0){e="checking"}else if(t.disconnected>0){e="disconnected"}else if(t["new"]>0){e="new"}else if(t.connected>0){e="connected"}else if(t.completed>0){e="completed"}if(e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}};n.prototype._updateConnectionState=function(){var e;var t={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){t[e.iceTransport.state]++;t[e.dtlsTransport.state]++});t.connected+=t.completed;e="new";if(t.failed>0){e="failed"}else if(t.connecting>0){e="connecting"}else if(t.disconnected>0){e="disconnected"}else if(t["new"]>0){e="new"}else if(t.connected>0){e="connected"}if(e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}};n.prototype.createOffer=function(){var s=this;if(s._isClosed){return Promise.reject(makeError("InvalidStateError","Can not call createOffer after close"))}var t=s.transceivers.filter(function(e){return e.kind==="audio"}).length;var r=s.transceivers.filter(function(e){return e.kind==="video"}).length;var e=arguments[0];if(e){if(e.mandatory||e.optional){throw new TypeError("Legacy mandatory/optional constraints not supported.")}if(e.offerToReceiveAudio!==undefined){if(e.offerToReceiveAudio===true){t=1}else if(e.offerToReceiveAudio===false){t=0}else{t=e.offerToReceiveAudio}}if(e.offerToReceiveVideo!==undefined){if(e.offerToReceiveVideo===true){r=1}else if(e.offerToReceiveVideo===false){r=0}else{r=e.offerToReceiveVideo}}}s.transceivers.forEach(function(e){if(e.kind==="audio"){t--;if(t<0){e.wantReceive=false}}else if(e.kind==="video"){r--;if(r<0){e.wantReceive=false}}});while(t>0||r>0){if(t>0){s._createTransceiver("audio");t--}if(r>0){s._createTransceiver("video");r--}}var n=j.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.transceivers.forEach(function(r,e){var t=r.track;var n=r.kind;var i=r.mid||j.generateIdentifier();r.mid=i;if(!r.iceGatherer){r.iceGatherer=s._createIceGatherer(e,s.usingBundle)}var a=I.RTCRtpSender.getCapabilities(n);if(L<15019){a.codecs=a.codecs.filter(function(e){return e.name!=="rtx"})}a.codecs.forEach(function(t){if(t.name==="H264"&&t.parameters["level-asymmetry-allowed"]===undefined){t.parameters["level-asymmetry-allowed"]="1"}if(r.remoteCapabilities&&r.remoteCapabilities.codecs){r.remoteCapabilities.codecs.forEach(function(e){if(t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate){t.preferredPayloadType=e.payloadType}})}});a.headerExtensions.forEach(function(t){var e=r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[];e.forEach(function(e){if(t.uri===e.uri){t.id=e.id}})});var o=r.sendEncodingParameters||[{ssrc:(2*e+1)*1001}];if(t){if(L>=15019&&n==="video"&&!o[0].rtx){o[0].rtx={ssrc:o[0].ssrc+1}}}if(r.wantReceive){r.rtpReceiver=new I.RTCRtpReceiver(r.dtlsTransport,n)}r.localCapabilities=a;r.sendEncodingParameters=o});if(s._config.bundlePolicy!=="max-compat"){n+="a=group:BUNDLE "+s.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}n+="a=ice-options:trickle\r\n";s.transceivers.forEach(function(e,t){n+=writeMediaSection(e,e.localCapabilities,"offer",e.stream,s._dtlsRole);n+="a=rtcp-rsize\r\n";if(e.iceGatherer&&s.iceGatheringState!=="new"&&(t===0||!s.usingBundle)){e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1;n+="a="+j.writeCandidate(e)+"\r\n"});if(e.iceGatherer.state==="completed"){n+="a=end-of-candidates\r\n"}}});var i=new I.RTCSessionDescription({type:"offer",sdp:n});return Promise.resolve(i)};n.prototype.createAnswer=function(){var a=this;if(a._isClosed){return Promise.reject(makeError("InvalidStateError","Can not call createAnswer after close"))}if(!(a.signalingState==="have-remote-offer"||a.signalingState==="have-local-pranswer")){return Promise.reject(makeError("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState))}var o=j.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);if(a.usingBundle){o+="a=group:BUNDLE "+a.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}var s=j.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(e,t){if(t+1>s){return}if(e.rejected){if(e.kind==="application"){if(e.protocol==="DTLS/SCTP"){o+="m=application 0 DTLS/SCTP 5000\r\n"}else{o+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n"}}else if(e.kind==="audio"){o+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\n"+"a=rtpmap:0 PCMU/8000\r\n"}else if(e.kind==="video"){o+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\n"+"a=rtpmap:120 VP8/90000\r\n"}o+="c=IN IP4 0.0.0.0\r\n"+"a=inactive\r\n"+"a=mid:"+e.mid+"\r\n";return}if(e.stream){var r;if(e.kind==="audio"){r=e.stream.getAudioTracks()[0]}else if(e.kind==="video"){r=e.stream.getVideoTracks()[0]}if(r){if(L>=15019&&e.kind==="video"&&!e.sendEncodingParameters[0].rtx){e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}}}}var n=getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);var i=n.codecs.filter(function(e){return e.name.toLowerCase()==="rtx"}).length;if(!i&&e.sendEncodingParameters[0].rtx){delete e.sendEncodingParameters[0].rtx}o+=writeMediaSection(e,n,"answer",e.stream,a._dtlsRole);if(e.rtcpParameters&&e.rtcpParameters.reducedSize){o+="a=rtcp-rsize\r\n"}});var e=new I.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(e)};n.prototype.addIceCandidate=function(c){var d=this;var p;if(c&&!(c.sdpMLineIndex!==undefined||c.sdpMid)){return Promise.reject(new TypeError("sdpMLineIndex or sdpMid required"))}return new Promise(function(e,t){if(!d._remoteDescription){return t(makeError("InvalidStateError","Can not add ICE candidate without a remote description"))}else if(!c||c.candidate===""){for(var r=0;r<d.transceivers.length;r++){if(d.transceivers[r].rejected){continue}d.transceivers[r].iceTransport.addRemoteCandidate({});p=j.getMediaSections(d._remoteDescription.sdp);p[r]+="a=end-of-candidates\r\n";d._remoteDescription.sdp=j.getDescription(d._remoteDescription.sdp)+p.join("");if(d.usingBundle){break}}}else{var n=c.sdpMLineIndex;if(c.sdpMid){for(var i=0;i<d.transceivers.length;i++){if(d.transceivers[i].mid===c.sdpMid){n=i;break}}}var a=d.transceivers[n];if(a){if(a.rejected){return e()}var o=Object.keys(c.candidate).length>0?j.parseCandidate(c.candidate):{};if(o.protocol==="tcp"&&(o.port===0||o.port===9)){return e()}if(o.component&&o.component!==1){return e()}if(n===0||n>0&&a.iceTransport!==d.transceivers[0].iceTransport){if(!maybeAddCandidate(a.iceTransport,o)){return t(makeError("OperationError","Can not add ICE candidate"))}}var s=c.candidate.trim();if(s.indexOf("a=")===0){s=s.substr(2)}p=j.getMediaSections(d._remoteDescription.sdp);p[n]+="a="+(o.type?s:"end-of-candidates")+"\r\n";d._remoteDescription.sdp=j.getDescription(d._remoteDescription.sdp)+p.join("")}else{return t(makeError("OperationError","Can not add ICE candidate"))}}e()})};n.prototype.getStats=function(t){if(t&&t instanceof I.MediaStreamTrack){var r=null;this.transceivers.forEach(function(e){if(e.rtpSender&&e.rtpSender.track===t){r=e.rtpSender}else if(e.rtpReceiver&&e.rtpReceiver.track===t){r=e.rtpReceiver}});if(!r){throw makeError("InvalidAccessError","Invalid selector.")}return r.getStats()}var n=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){if(t[e]){n.push(t[e].getStats())}})});return Promise.all(n).then(function(e){var t=new Map;e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})});return t})};var e=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];e.forEach(function(e){var t=I[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then(function(t){var r=new Map;Object.keys(t).forEach(function(e){t[e].type=fixStatsType(t[e]);r.set(e,t[e])});return r})}}});var t=["createOffer","createAnswer"];t.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;if(typeof t[0]==="function"||typeof t[1]==="function"){return r.apply(this,[arguments[2]]).then(function(e){if(typeof t[0]==="function"){t[0].apply(null,[e])}},function(e){if(typeof t[1]==="function"){t[1].apply(null,[e])}})}return r.apply(this,arguments)}});t=["setLocalDescription","setRemoteDescription","addIceCandidate"];t.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;if(typeof t[1]==="function"||typeof t[2]==="function"){return r.apply(this,arguments).then(function(){if(typeof t[1]==="function"){t[1].apply(null)}},function(e){if(typeof t[2]==="function"){t[2].apply(null,[e])}})}return r.apply(this,arguments)}});["getStats"].forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;if(typeof e[1]==="function"){return t.apply(this,arguments).then(function(){if(typeof e[1]==="function"){e[1].apply(null)}})}return t.apply(this,arguments)}});return n}},{sdp:2}],2:[function(e,t,r){"use strict";var p={};p.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)};p.localCName=p.generateIdentifier();p.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})};p.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})};p.getDescription=function(e){var t=p.splitSections(e);return t&&t[0]};p.getMediaSections=function(e){var t=p.splitSections(e);t.shift();return t};p.matchPrefix=function(e,t){return p.splitLines(e).filter(function(e){return e.indexOf(t)===0})};p.parseCandidate=function(e){var t;if(e.indexOf("a=candidate:")===0){t=e.substring(12).split(" ")}else{t=e.substring(10).split(" ")}var r={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]};for(var n=8;n<t.length;n+=2){switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1];r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1];break}}return r};p.writeCandidate=function(e){var t=[];t.push(e.foundation);t.push(e.component);t.push(e.protocol.toUpperCase());t.push(e.priority);t.push(e.ip);t.push(e.port);var r=e.type;t.push("typ");t.push(r);if(r!=="host"&&e.relatedAddress&&e.relatedPort){t.push("raddr");t.push(e.relatedAddress);t.push("rport");t.push(e.relatedPort)}if(e.tcpType&&e.protocol.toLowerCase()==="tcp"){t.push("tcptype");t.push(e.tcpType)}if(e.usernameFragment||e.ufrag){t.push("ufrag");t.push(e.usernameFragment||e.ufrag)}return"candidate:"+t.join(" ")};p.parseIceOptions=function(e){return e.substr(14).split(" ")};p.parseRtpMap=function(e){var t=e.substr(9).split(" ");var r={payloadType:parseInt(t.shift(),10)};t=t[0].split("/");r.name=t[0];r.clockRate=parseInt(t[1],10);r.channels=t.length===3?parseInt(t[2],10):1;r.numChannels=r.channels;return r};p.writeRtpMap=function(e){var t=e.payloadType;if(e.preferredPayloadType!==undefined){t=e.preferredPayloadType}var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(r!==1?"/"+r:"")+"\r\n"};p.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}};p.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&e.direction!=="sendrecv"?"/"+e.direction:"")+" "+e.uri+"\r\n"};p.parseFmtp=function(e){var t={};var r;var n=e.substr(e.indexOf(" ")+1).split(";");for(var i=0;i<n.length;i++){r=n[i].trim().split("=");t[r[0].trim()]=r[1]}return t};p.writeFmtp=function(t){var e="";var r=t.payloadType;if(t.preferredPayloadType!==undefined){r=t.preferredPayloadType}if(t.parameters&&Object.keys(t.parameters).length){var n=[];Object.keys(t.parameters).forEach(function(e){if(t.parameters[e]){n.push(e+"="+t.parameters[e])}else{n.push(e)}});e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return e};p.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}};p.writeRtcpFb=function(e){var t="";var r=e.payloadType;if(e.preferredPayloadType!==undefined){r=e.preferredPayloadType}if(e.rtcpFeedback&&e.rtcpFeedback.length){e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})}return t};p.parseSsrcMedia=function(e){var t=e.indexOf(" ");var r={ssrc:parseInt(e.substr(7,t-7),10)};var n=e.indexOf(":",t);if(n>-1){r.attribute=e.substr(t+1,n-t-1);r.value=e.substr(n+1)}else{r.attribute=e.substr(t+1)}return r};p.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}};p.getMid=function(e){var t=p.matchPrefix(e,"a=mid:")[0];if(t){return t.substr(6)}};p.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}};p.getDtlsParameters=function(e,t){var r=p.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:r.map(p.parseFingerprint)}};p.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"});return r};p.getIceParameters=function(e,t){var r=p.splitLines(e);r=r.concat(p.splitLines(t));var n={usernameFragment:r.filter(function(e){return e.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:r.filter(function(e){return e.indexOf("a=ice-pwd:")===0})[0].substr(10)};return n};p.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\n"+"a=ice-pwd:"+e.password+"\r\n"};p.parseRtpParameters=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]};var r=p.splitLines(e);var n=r[0].split(" ");for(var i=3;i<n.length;i++){var a=n[i];var o=p.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(o){var s=p.parseRtpMap(o);var c=p.matchPrefix(e,"a=fmtp:"+a+" ");s.parameters=c.length?p.parseFmtp(c[0]):{};s.rtcpFeedback=p.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(p.parseRtcpFb);t.codecs.push(s);switch(s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase());break;default:break}}}p.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(p.parseExtmap(e))});return t};p.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ";r+=t.codecs.length>0?"9":"0";r+=" UDP/TLS/RTP/SAVPF ";r+=t.codecs.map(function(e){if(e.preferredPayloadType!==undefined){return e.preferredPayloadType}return e.payloadType}).join(" ")+"\r\n";r+="c=IN IP4 0.0.0.0\r\n";r+="a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){r+=p.writeRtpMap(e);r+=p.writeFmtp(e);r+=p.writeRtcpFb(e)});var n=0;t.codecs.forEach(function(e){if(e.maxptime>n){n=e.maxptime}});if(n>0){r+="a=maxptime:"+n+"\r\n"}r+="a=rtcp-mux\r\n";if(t.headerExtensions){t.headerExtensions.forEach(function(e){r+=p.writeExtmap(e)})}return r};p.parseRtpEncodingParameters=function(e){var r=[];var t=p.parseRtpParameters(e);var n=t.fecMechanisms.indexOf("RED")!==-1;var i=t.fecMechanisms.indexOf("ULPFEC")!==-1;var a=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="cname"});var o=a.length>0&&a[0].ssrc;var s;var c=p.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.substr(17).split(" ");return t.map(function(e){return parseInt(e,10)})});if(c.length>0&&c[0].length>1&&c[0][0]===o){s=c[0][1]}t.codecs.forEach(function(e){if(e.name.toUpperCase()==="RTX"&&e.parameters.apt){var t={ssrc:o,codecPayloadType:parseInt(e.parameters.apt,10)};if(o&&s){t.rtx={ssrc:s}}r.push(t);if(n){t=JSON.parse(JSON.stringify(t));t.fec={ssrc:s,mechanism:i?"red+ulpfec":"red"};r.push(t)}}});if(r.length===0&&o){r.push({ssrc:o})}var d=p.matchPrefix(e,"b=");if(d.length){if(d[0].indexOf("b=TIAS:")===0){d=parseInt(d[0].substr(7),10)}else if(d[0].indexOf("b=AS:")===0){d=parseInt(d[0].substr(5),10)*1e3*.95-50*40*8}else{d=undefined}r.forEach(function(e){e.maxBitrate=d})}return r};p.parseRtcpParameters=function(e){var t={};var r=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="cname"})[0];if(r){t.cname=r.value;t.ssrc=r.ssrc}var n=p.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0;t.compound=n.length===0;var i=p.matchPrefix(e,"a=rtcp-mux");t.mux=i.length>0;return t};p.parseMsid=function(e){var t;var r=p.matchPrefix(e,"a=msid:");if(r.length===1){t=r[0].substr(7).split(" ");return{stream:t[0],track:t[1]}}var n=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="msid"});if(n.length>0){t=n[0].value.split(" ");return{stream:t[0],track:t[1]}}};p.generateSessionId=function(){return Math.random().toString().substr(2,21)};p.writeSessionBoilerplate=function(e,t){var r;var n=t!==undefined?t:2;if(e){r=e}else{r=p.generateSessionId()}return"v=0\r\n"+"o=thisisadapterortc "+r+" "+n+" IN IP4 127.0.0.1\r\n"+"s=-\r\n"+"t=0 0\r\n"};p.writeMediaSection=function(e,t,r,n){var i=p.writeRtpDescription(e.kind,t);i+=p.writeIceParameters(e.iceGatherer.getLocalParameters());i+=p.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":"active");i+="a=mid:"+e.mid+"\r\n";if(e.direction){i+="a="+e.direction+"\r\n"}else if(e.rtpSender&&e.rtpReceiver){i+="a=sendrecv\r\n"}else if(e.rtpSender){i+="a=sendonly\r\n"}else if(e.rtpReceiver){i+="a=recvonly\r\n"}else{i+="a=inactive\r\n"}if(e.rtpSender){var a="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a;i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a;if(e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a;i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"}return i};p.getDirection=function(e,t){var r=p.splitLines(e);for(var n=0;n<r.length;n++){switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2);default:}}if(t){return p.getDirection(t)}return"sendrecv"};p.getKind=function(e){var t=p.splitLines(e);var r=t[0].split(" ");return r[0].substr(2)};p.isRejected=function(e){return e.split(" ",2)[1]==="0"};p.parseMLine=function(e){var t=p.splitLines(e);var r=t[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}};p.parseOLine=function(e){var t=p.matchPrefix(e,"o=")[0];var r=t.substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}};p.isValidSDP=function(e){if(typeof e!=="string"||e.length===0){return false}var t=p.splitLines(e);for(var r=0;r<t.length;r++){if(t[r].length<2||t[r].charAt(1)!=="="){return false}}return true};if(typeof t==="object"){t.exports=p}},{}],3:[function(r,n,e){(function(e){"use strict";var t=r("./adapter_factory.js");n.exports=t({window:e.window})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./adapter_factory.js":4}],4:[function(l,e,t){"use strict";var v=l("./utils");e.exports=function(e,t){var r=e&&e.window;var n={shimChrome:true,shimFirefox:true,shimEdge:true,shimSafari:true};for(var i in t){if(hasOwnProperty.call(t,i)){n[i]=t[i]}}var a=v.log;var o=v.detectBrowser(r);var s=l("./chrome/chrome_shim")||null;var c=l("./edge/edge_shim")||null;var d=l("./firefox/firefox_shim")||null;var p=l("./safari/safari_shim")||null;var f=l("./common_shim")||null;var u={browserDetails:o,commonShim:f,extractVersion:v.extractVersion,disableLog:v.disableLog,disableWarnings:v.disableWarnings};switch(o.browser){case"chrome":if(!s||!s.shimPeerConnection||!n.shimChrome){a("Chrome shim is not included in this adapter release.");return u}a("adapter.js shimming chrome.");u.browserShim=s;f.shimCreateObjectURL(r);s.shimGetUserMedia(r);s.shimMediaStream(r);s.shimSourceObject(r);s.shimPeerConnection(r);s.shimOnTrack(r);s.shimAddTrackRemoveTrack(r);s.shimGetSendersWithDtmf(r);s.shimSenderReceiverGetStats(r);s.fixNegotiationNeeded(r);f.shimRTCIceCandidate(r);f.shimMaxMessageSize(r);f.shimSendThrowTypeError(r);break;case"firefox":if(!d||!d.shimPeerConnection||!n.shimFirefox){a("Firefox shim is not included in this adapter release.");return u}a("adapter.js shimming firefox.");u.browserShim=d;f.shimCreateObjectURL(r);d.shimGetUserMedia(r);d.shimSourceObject(r);d.shimPeerConnection(r);d.shimOnTrack(r);d.shimRemoveStream(r);d.shimSenderGetStats(r);d.shimReceiverGetStats(r);d.shimRTCDataChannel(r);f.shimRTCIceCandidate(r);f.shimMaxMessageSize(r);f.shimSendThrowTypeError(r);break;case"edge":if(!c||!c.shimPeerConnection||!n.shimEdge){a("MS edge shim is not included in this adapter release.");return u}a("adapter.js shimming edge.");u.browserShim=c;f.shimCreateObjectURL(r);c.shimGetUserMedia(r);c.shimPeerConnection(r);c.shimReplaceTrack(r);f.shimMaxMessageSize(r);f.shimSendThrowTypeError(r);break;case"safari":if(!p||!n.shimSafari){a("Safari shim is not included in this adapter release.");return u}a("adapter.js shimming safari.");u.browserShim=p;f.shimCreateObjectURL(r);p.shimRTCIceServerUrls(r);p.shimCreateOfferLegacy(r);p.shimCallbacksAPI(r);p.shimLocalStreamsAPI(r);p.shimRemoteStreamsAPI(r);p.shimTrackEventTransceiver(r);p.shimGetUserMedia(r);f.shimRTCIceCandidate(r);f.shimMaxMessageSize(r);f.shimSendThrowTypeError(r);break;default:a("Unsupported browser!");break}return u}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":11,"./safari/safari_shim":13,"./utils":14}],5:[function(e,t,r){"use strict";var d=e("../utils.js");var n=d.log;function walkStats(t,r,n){if(!r||n.has(r.id)){return}n.set(r.id,r);Object.keys(r).forEach(function(e){if(e.endsWith("Id")){walkStats(t,t.get(r[e]),n)}else if(e.endsWith("Ids")){r[e].forEach(function(e){walkStats(t,t.get(e),n)})}})}function filterStats(r,t,e){var n=e?"outbound-rtp":"inbound-rtp";var i=new Map;if(t===null){return i}var a=[];r.forEach(function(e){if(e.type==="track"&&e.trackIdentifier===t.id){a.push(e)}});a.forEach(function(t){r.forEach(function(e){if(e.type===n&&e.trackId===t.id){walkStats(r,e,i)}})});return i}t.exports={shimGetUserMedia:e("./getusermedia"),shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(a){if(typeof a==="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){if(this._ontrack){this.removeEventListener("track",this._ontrack)}this.addEventListener("track",this._ontrack=e)},enumerable:true,configurable:true});var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;if(!i._ontrackpoly){i._ontrackpoly=function(n){n.stream.addEventListener("addtrack",function(t){var e;if(a.RTCPeerConnection.prototype.getReceivers){e=i.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id})}else{e={track:t.track}}var r=new Event("track");r.track=t.track;r.receiver=e;r.transceiver={receiver:e};r.streams=[n.stream];i.dispatchEvent(r)});n.stream.getTracks().forEach(function(t){var e;if(a.RTCPeerConnection.prototype.getReceivers){e=i.getReceivers().find(function(e){return e.track&&e.track.id===t.id})}else{e={track:t}}var r=new Event("track");r.track=t;r.receiver=e;r.transceiver={receiver:e};r.streams=[n.stream];i.dispatchEvent(r)})};i.addEventListener("addstream",i._ontrackpoly)}return e.apply(i,arguments)}}else if(!("RTCRtpTransceiver"in a)){d.wrapPeerConnectionEvent(a,"track",function(e){if(!e.transceiver){e.transceiver={receiver:e.receiver}}return e})}},shimGetSendersWithDtmf:function(e){if(typeof e==="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var i=function(e,t){return{track:t,get dtmf(){if(this._dtmf===undefined){if(t.kind==="audio"){this._dtmf=e.createDTMFSender(t)}else{this._dtmf=null}}return this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var a=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){var r=this;var n=a.apply(r,arguments);if(!n){n=i(r,e);r._senders.push(n)}return n};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;n.apply(t,arguments);var r=t._senders.indexOf(e);if(r!==-1){t._senders.splice(r,1)}}}var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;t._senders=t._senders||[];r.apply(t,[e]);e.getTracks().forEach(function(e){t._senders.push(i(t,e))})};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var r=this;r._senders=r._senders||[];t.apply(r,[e]);e.getTracks().forEach(function(t){var e=r._senders.find(function(e){return e.track===t});if(e){r._senders.splice(r._senders.indexOf(e),1)}})}}else if(typeof e==="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var t=this;var e=o.apply(t,[]);e.forEach(function(e){e._pc=t});return e};Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){if(this._dtmf===undefined){if(this.track.kind==="audio"){this._dtmf=this._pc.createDTMFSender(this.track)}else{this._dtmf=null}}return this._dtmf}})}},shimSenderReceiverGetStats:function(a){if(!(typeof a==="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver)){return}if(!("getStats"in a.RTCRtpSender.prototype)){var r=a.RTCPeerConnection.prototype.getSenders;if(r){a.RTCPeerConnection.prototype.getSenders=function(){var t=this;var e=r.apply(t,[]);e.forEach(function(e){e._pc=t});return e}}var t=a.RTCPeerConnection.prototype.addTrack;if(t){a.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);e._pc=this;return e}}a.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return filterStats(e,t.track,true)})}}if(!("getStats"in a.RTCRtpReceiver.prototype)){var n=a.RTCPeerConnection.prototype.getReceivers;if(n){a.RTCPeerConnection.prototype.getReceivers=function(){var t=this;var e=n.apply(t,[]);e.forEach(function(e){e._pc=t});return e}}d.wrapPeerConnectionEvent(a,"track",function(e){e.receiver._pc=e.srcElement;return e});a.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return filterStats(e,t.track,false)})}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype)){return}var o=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var e=this;if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){var t=arguments[0];var r;var n;var i;e.getSenders().forEach(function(e){if(e.track===t){if(r){i=true}else{r=e}}});e.getReceivers().forEach(function(e){if(e.track===t){if(n){i=true}else{n=e}}return e.track===t});if(i||r&&n){return Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError"))}else if(r){return r.getStats()}else if(n){return n.getStats()}return Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(e,arguments)}},shimSourceObject:function(e){var r=e&&e.URL;if(typeof e==="object"){if(e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)){Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;this._srcObject=e;if(this.src){r.revokeObjectURL(this.src)}if(!e){this.src="";return undefined}this.src=r.createObjectURL(e);e.addEventListener("addtrack",function(){if(t.src){r.revokeObjectURL(t.src)}t.src=r.createObjectURL(e)});e.addEventListener("removetrack",function(){if(t.src){r.revokeObjectURL(t.src)}t.src=r.createObjectURL(e)})}})}}},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t){return n.apply(this,arguments)}this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=n.apply(this,arguments);if(!this._shimmedLocalStreams[t.id]){this._shimmedLocalStreams[t.id]=[t,r]}else if(this._shimmedLocalStreams[t.id].indexOf(r)===-1){this._shimmedLocalStreams[t.id].push(r)}return r};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});if(e){throw new DOMException("Track already exists.","InvalidAccessError")}});var t=r.getSenders();i.apply(this,arguments);var n=r.getSenders().filter(function(e){return t.indexOf(e)===-1});this._shimmedLocalStreams[e.id]=[e].concat(n)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[e.id];return t.apply(this,arguments)};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};if(r){Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=n._shimmedLocalStreams[e].indexOf(r);if(t!==-1){n._shimmedLocalStreams[e].splice(t,1)}if(n._shimmedLocalStreams[e].length===1){delete n._shimmedLocalStreams[e]}})}return a.apply(this,arguments)}},shimAddTrackRemoveTrack:function(s){var e=d.detectBrowser(s);if(s.RTCPeerConnection.prototype.addTrack&&e.version>=65){return this.shimAddTrackRemoveTrackWithNative(s)}var r=s.RTCPeerConnection.prototype.getLocalStreams;s.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;var e=r.apply(this);t._reverseStreams=t._reverseStreams||{};return e.map(function(e){return t._reverseStreams[e.id]})};var n=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(e){var r=this;r._streams=r._streams||{};r._reverseStreams=r._reverseStreams||{};e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});if(e){throw new DOMException("Track already exists.","InvalidAccessError")}});if(!r._reverseStreams[e.id]){var t=new s.MediaStream(e.getTracks());r._streams[e.id]=t;r._reverseStreams[t.id]=e;e=t}n.apply(r,[e])};var i=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{};t._reverseStreams=t._reverseStreams||{};i.apply(t,[t._streams[e.id]||e]);delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id];delete t._streams[e.id]};s.RTCPeerConnection.prototype.addTrack=function(t,e){var r=this;if(r.signalingState==="closed"){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}var n=[].slice.call(arguments,1);if(n.length!==1||!n[0].getTracks().find(function(e){return e===t})){throw new DOMException("The adapter.js addTrack polyfill only supports a single "+" stream which is associated with the specified track.","NotSupportedError")}var i=r.getSenders().find(function(e){return e.track===t});if(i){throw new DOMException("Track already exists.","InvalidAccessError")}r._streams=r._streams||{};r._reverseStreams=r._reverseStreams||{};var a=r._streams[e.id];if(a){a.addTrack(t);Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))})}else{var o=new s.MediaStream([t]);r._streams[e.id]=o;r._reverseStreams[o.id]=e;r.addStream(o)}return r.getSenders().find(function(e){return e.track===t})};function replaceInternalStreamId(n,e){var i=e.sdp;Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e];var r=n._streams[t.id];i=i.replace(new RegExp(r.id,"g"),t.id)});return new RTCSessionDescription({type:e.type,sdp:i})}function replaceExternalStreamId(n,e){var i=e.sdp;Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e];var r=n._streams[t.id];i=i.replace(new RegExp(t.id,"g"),r.id)});return new RTCSessionDescription({type:e.type,sdp:i})}["createOffer","createAnswer"].forEach(function(e){var t=s.RTCPeerConnection.prototype[e];s.RTCPeerConnection.prototype[e]=function(){var r=this;var n=arguments;var e=arguments.length&&typeof arguments[0]==="function";if(e){return t.apply(r,[function(e){var t=replaceInternalStreamId(r,e);n[0].apply(null,[t])},function(e){if(n[1]){n[1].apply(null,e)}},arguments[2]])}return t.apply(r,arguments).then(function(e){return replaceInternalStreamId(r,e)})}});var t=s.RTCPeerConnection.prototype.setLocalDescription;s.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;if(!arguments.length||!arguments[0].type){return t.apply(e,arguments)}arguments[0]=replaceExternalStreamId(e,arguments[0]);return t.apply(e,arguments)};var a=Object.getOwnPropertyDescriptor(s.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(s.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=this;var t=a.get.apply(this);if(t.type===""){return t}return replaceInternalStreamId(e,t)}});s.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;if(n.signalingState==="closed"){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}if(!r._pc){throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack "+"does not implement interface RTCRtpSender.","TypeError")}var e=r._pc===n;if(!e){throw new DOMException("Sender was not created by this connection.","InvalidAccessError")}n._streams=n._streams||{};var i;Object.keys(n._streams).forEach(function(e){var t=n._streams[e].getTracks().find(function(e){return r.track===e});if(t){i=n._streams[e]}});if(i){if(i.getTracks().length===1){n.removeStream(n._reverseStreams[i.id])}else{i.removeTrack(r.track)}n.dispatchEvent(new Event("negotiationneeded"))}}},shimPeerConnection:function(r){var e=d.detectBrowser(r);if(!r.RTCPeerConnection&&r.webkitRTCPeerConnection){r.RTCPeerConnection=function(e,t){n("PeerConnection");if(e&&e.iceTransportPolicy){e.iceTransports=e.iceTransportPolicy}return new r.webkitRTCPeerConnection(e,t)};r.RTCPeerConnection.prototype=r.webkitRTCPeerConnection.prototype;if(r.webkitRTCPeerConnection.generateCertificate){Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:function(){return r.webkitRTCPeerConnection.generateCertificate}})}}else{var a=r.RTCPeerConnection;r.RTCPeerConnection=function(e,t){if(e&&e.iceServers){var r=[];for(var n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];if(!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")){d.deprecated("RTCIceServer.url","RTCIceServer.urls");i=JSON.parse(JSON.stringify(i));i.urls=i.url;r.push(i)}else{r.push(e.iceServers[n])}}e.iceServers=r}return new a(e,t)};r.RTCPeerConnection.prototype=a.prototype;Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})}var c=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(e,t,r){var n=this;var i=arguments;if(arguments.length>0&&typeof e==="function"){return c.apply(this,arguments)}if(c.length===0&&(arguments.length===0||typeof arguments[0]!=="function")){return c.apply(this,[])}var a=function(e){var n={};var t=e.result();t.forEach(function(t){var r={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){r[e]=t.stat(e)});n[r.id]=r});return n};var o=function(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))};if(arguments.length>=2){var s=function(e){i[1](o(a(e)))};return c.apply(this,[s,arguments[0]])}return new Promise(function(t,e){c.apply(n,[function(e){t(o(a(e)))},e])}).then(t,r)};if(e.version<51){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var i=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){var r=arguments;var n=this;var e=new Promise(function(e,t){i.apply(n,[r[0],e,t])});if(r.length<2){return e}return e.then(function(){r[1].apply(null,[])},function(e){if(r.length>=3){r[2].apply(null,[e])}})}})}if(e.version<52){["createOffer","createAnswer"].forEach(function(e){var i=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){var r=this;if(arguments.length<1||arguments.length===1&&typeof arguments[0]==="object"){var n=arguments.length===1?arguments[0]:undefined;return new Promise(function(e,t){i.apply(r,[e,t,n])})}return i.apply(this,arguments)}})}["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){arguments[0]=new(e==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]);return t.apply(this,arguments)}});var t=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}return t.apply(this,arguments)}},fixNegotiationNeeded:function(e){d.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){var t=e.target;if(t.signalingState!=="stable"){return}return e})},shimGetDisplayMedia:function(e,r){if("getDisplayMedia"in e.navigator){return}if(typeof r!=="function"){console.error("shimGetDisplayMedia: getSourceId argument is not "+"a function");return}navigator.getDisplayMedia=function(t){return r(t).then(function(e){t.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:t.video.frameRate||3}};return navigator.mediaDevices.getUserMedia(t)})}}}},{"../utils.js":14,"./getusermedia":6}],6:[function(e,t,r){"use strict";var d=e("../utils.js");var p=d.log;t.exports=function(e){var o=d.detectBrowser(e);var s=e&&e.navigator;var c=function(i){if(typeof i!=="object"||i.mandatory||i.optional){return i}var a={};Object.keys(i).forEach(function(t){if(t==="require"||t==="advanced"||t==="mediaSource"){return}var r=typeof i[t]==="object"?i[t]:{ideal:i[t]};if(r.exact!==undefined&&typeof r.exact==="number"){r.min=r.max=r.exact}var n=function(e,t){if(e){return e+t.charAt(0).toUpperCase()+t.slice(1)}return t==="deviceId"?"sourceId":t};if(r.ideal!==undefined){a.optional=a.optional||[];var e={};if(typeof r.ideal==="number"){e[n("min",t)]=r.ideal;a.optional.push(e);e={};e[n("max",t)]=r.ideal;a.optional.push(e)}else{e[n("",t)]=r.ideal;a.optional.push(e)}}if(r.exact!==undefined&&typeof r.exact!=="number"){a.mandatory=a.mandatory||{};a.mandatory[n("",t)]=r.exact}else{["min","max"].forEach(function(e){if(r[e]!==undefined){a.mandatory=a.mandatory||{};a.mandatory[n(e,t)]=r[e]}})}});if(i.advanced){a.optional=(a.optional||[]).concat(i.advanced)}return a};var n=function(r,n){if(o.version>=61){return n(r)}r=JSON.parse(JSON.stringify(r));if(r&&typeof r.audio==="object"){var e=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}};r=JSON.parse(JSON.stringify(r));e(r.audio,"autoGainControl","googAutoGainControl");e(r.audio,"noiseSuppression","googNoiseSuppression");r.audio=c(r.audio)}if(r&&typeof r.video==="object"){var i=r.video.facingMode;i=i&&(typeof i==="object"?i:{ideal:i});var t=o.version<66;if(i&&(i.exact==="user"||i.exact==="environment"||i.ideal==="user"||i.ideal==="environment")&&!(s.mediaDevices.getSupportedConstraints&&s.mediaDevices.getSupportedConstraints().facingMode&&!t)){delete r.video.facingMode;var a;if(i.exact==="environment"||i.ideal==="environment"){a=["back","rear"]}else if(i.exact==="user"||i.ideal==="user"){a=["front"]}if(a){return s.mediaDevices.enumerateDevices().then(function(e){e=e.filter(function(e){return e.kind==="videoinput"});var t=e.find(function(t){return a.some(function(e){return t.label.toLowerCase().indexOf(e)!==-1})});if(!t&&e.length&&a.indexOf("back")!==-1){t=e[e.length-1]}if(t){r.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}}r.video=c(r.video);p("chrome: "+JSON.stringify(r));return n(r)})}}r.video=c(r.video)}p("chrome: "+JSON.stringify(r));return n(r)};var i=function(e){if(o.version>=64){return e}return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};var t=function(e,t,r){n(e,function(e){s.webkitGetUserMedia(e,t,function(e){if(r){r(i(e))}})})};s.getUserMedia=t;var r=function(r){return new Promise(function(e,t){s.getUserMedia(r,e,t)})};if(!s.mediaDevices){s.mediaDevices={getUserMedia:r,enumerateDevices:function(){return new Promise(function(t){var r={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:r[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:true,echoCancellation:true,facingMode:true,frameRate:true,height:true,width:true}}}}if(!s.mediaDevices.getUserMedia){s.mediaDevices.getUserMedia=function(e){return r(e)}}else{var a=s.mediaDevices.getUserMedia.bind(s.mediaDevices);s.mediaDevices.getUserMedia=function(e){return n(e,function(t){return a(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length){e.getTracks().forEach(function(e){e.stop()});throw new DOMException("","NotFoundError")}return e},function(e){return Promise.reject(i(e))})})}}if(typeof s.mediaDevices.addEventListener==="undefined"){s.mediaDevices.addEventListener=function(){p("Dummy mediaDevices.addEventListener called.")}}if(typeof s.mediaDevices.removeEventListener==="undefined"){s.mediaDevices.removeEventListener=function(){p("Dummy mediaDevices.removeEventListener called.")}}}},{"../utils.js":14}],7:[function(e,t,r){"use strict";var a=e("sdp");var f=e("./utils");t.exports={shimRTCIceCandidate:function(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype){return}var i=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if(typeof e==="object"&&e.candidate&&e.candidate.indexOf("a=")===0){e=JSON.parse(JSON.stringify(e));e.candidate=e.candidate.substr(2)}if(e.candidate&&e.candidate.length){var t=new i(e);var r=a.parseCandidate(e.candidate);var n=Object.assign(t,r);n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}};return n}return new i(e)};t.RTCIceCandidate.prototype=i.prototype;f.wrapPeerConnectionEvent(t,"icecandidate",function(e){if(e.candidate){Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"})}return e})},shimCreateObjectURL:function(e){var t=e&&e.URL;if(!(typeof e==="object"&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL)){return undefined}var r=t.createObjectURL.bind(t);var n=t.revokeObjectURL.bind(t);var i=new Map,a=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++a;i.set(t,e);f.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream");return t}return r(e)};t.revokeObjectURL=function(e){n(e);i["delete"](e)};var o=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return o.get.apply(this)},set:function(e){this.srcObject=i.get(e)||null;return o.set.apply(this,[e])}});var s=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){if(arguments.length===2&&(""+arguments[0]).toLowerCase()==="src"){this.srcObject=i.get(arguments[1])||null}return s.apply(this,arguments)}},shimMaxMessageSize:function(e){if(e.RTCSctpTransport||!e.RTCPeerConnection){return}var i=f.detectBrowser(e);if(!("sctp"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return typeof this._sctp==="undefined"?null:this._sctp}})}var o=function(e){var t=a.splitSections(e.sdp);t.shift();return t.some(function(e){var t=a.parseMLine(e);return t&&t.kind==="application"&&t.protocol.indexOf("SCTP")!==-1})};var s=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(t===null||t.length<2){return-1}var r=parseInt(t[1],10);return r!==r?-1:r};var c=function(e){var t=65536;if(i.browser==="firefox"){if(i.version<57){if(e===-1){t=16384}else{t=2147483637}}else if(i.version<60){t=i.version===57?65535:65536}else{t=2147483637}}return t};var d=function(e,t){var r=65536;if(i.browser==="firefox"&&i.version===57){r=65535}var n=a.matchPrefix(e.sdp,"a=max-message-size:");if(n.length>0){r=parseInt(n[0].substr(19),10)}else if(i.browser==="firefox"&&t!==-1){r=2147483637}return r};var p=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;e._sctp=null;if(o(arguments[0])){var t=s(arguments[0]);var r=c(t);var n=d(arguments[0],t);var i;if(r===0&&n===0){i=Number.POSITIVE_INFINITY}else if(r===0||n===0){i=Math.max(r,n)}else{i=Math.min(r,n)}var a={};Object.defineProperty(a,"maxMessageSize",{get:function(){return i}});e._sctp=a}return p.apply(e,arguments)}},shimSendThrowTypeError:function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype)){return}function wrapDcSend(r,n){var i=r.send;r.send=function(){var e=arguments[0];var t=e.length||e.size||e.byteLength;if(r.readyState==="open"&&n.sctp&&t>n.sctp.maxMessageSize){throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)")}return i.apply(r,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=this;var t=r.apply(e,arguments);wrapDcSend(t,e);return t};f.wrapPeerConnectionEvent(e,"datachannel",function(e){wrapDcSend(e.channel,e.target);return e})}}},{"./utils":14,sdp:2}],8:[function(e,t,r){"use strict";var i=e("../utils");var a=e("./filtericeservers");var o=e("rtcpeerconnection-shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(e){var t=i.detectBrowser(e);if(e.RTCIceGatherer){if(!e.RTCIceCandidate){e.RTCIceCandidate=function(e){return e}}if(!e.RTCSessionDescription){e.RTCSessionDescription=function(e){return e}}if(t.version<15025){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e;this.dispatchEvent(t)}})}}if(e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){if(this._dtmf===undefined){if(this.track.kind==="audio"){this._dtmf=new e.RTCDtmfSender(this)}else if(this.track.kind==="video"){this._dtmf=null}}return this._dtmf}})}if(e.RTCDtmfSender&&!e.RTCDTMFSender){e.RTCDTMFSender=e.RTCDtmfSender}var n=o(e,t.version);e.RTCPeerConnection=function(e){if(e&&e.iceServers){e.iceServers=a(e.iceServers)}return new n(e)};e.RTCPeerConnection.prototype=n.prototype},shimReplaceTrack:function(e){if(e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)){e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack}}}},{"../utils":14,"./filtericeservers":9,"./getusermedia":10,"rtcpeerconnection-shim":1}],9:[function(e,t,r){"use strict";var a=e("../utils");t.exports=function(e,n){var i=false;e=JSON.parse(JSON.stringify(e));return e.filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;if(e.url&&!e.urls){a.deprecated("RTCIceServer.url","RTCIceServer.urls")}var r=typeof t==="string";if(r){t=[t]}t=t.filter(function(e){var t=e.indexOf("turn:")===0&&e.indexOf("transport=udp")!==-1&&e.indexOf("turn:[")===-1&&!i;if(t){i=true;return true}return e.indexOf("stun:")===0&&n>=14393&&e.indexOf("?transport=udp")===-1});delete e.url;e.urls=r?t[0]:t;return!!t.length}})}},{"../utils":14}],10:[function(e,t,r){"use strict";t.exports=function(e){var t=e&&e.navigator;var r=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}};var n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e)["catch"](function(e){return Promise.reject(r(e))})}}},{}],11:[function(t,r,n){"use strict";var d=t("../utils");r.exports={shimGetUserMedia:t("./getusermedia"),shimOnTrack:function(e){if(typeof e==="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){if(this._ontrack){this.removeEventListener("track",this._ontrack);this.removeEventListener("addstream",this._ontrackpoly)}this.addEventListener("track",this._ontrack=e);this.addEventListener("addstream",this._ontrackpoly=function(r){r.stream.getTracks().forEach(function(e){var t=new Event("track");t.track=e;t.receiver={track:e};t.transceiver={receiver:t.receiver};t.streams=[r.stream];this.dispatchEvent(t)}.bind(this))}.bind(this))},enumerable:true,configurable:true})}if(typeof e==="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}},shimSourceObject:function(e){if(typeof e==="object"){if(e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)){Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}})}}},shimPeerConnection:function(s){var c=d.detectBrowser(s);if(typeof s!=="object"||!(s.RTCPeerConnection||s.mozRTCPeerConnection)){return}if(!s.RTCPeerConnection){s.RTCPeerConnection=function(e,t){if(c.version<38){if(e&&e.iceServers){var r=[];for(var n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];if(i.hasOwnProperty("urls")){for(var a=0;a<i.urls.length;a++){var o={url:i.urls[a]};if(i.urls[a].indexOf("turn")===0){o.username=i.username;o.credential=i.credential}r.push(o)}}else{r.push(e.iceServers[n])}}e.iceServers=r}}return new s.mozRTCPeerConnection(e,t)};s.RTCPeerConnection.prototype=s.mozRTCPeerConnection.prototype;if(s.mozRTCPeerConnection.generateCertificate){Object.defineProperty(s.RTCPeerConnection,"generateCertificate",{get:function(){return s.mozRTCPeerConnection.generateCertificate}})}s.RTCSessionDescription=s.mozRTCSessionDescription;s.RTCIceCandidate=s.mozRTCIceCandidate}["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=s.RTCPeerConnection.prototype[e];s.RTCPeerConnection.prototype[e]=function(){arguments[0]=new(e==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]);return t.apply(this,arguments)}});var t=s.RTCPeerConnection.prototype.addIceCandidate;s.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}return t.apply(this,arguments)};var i=function(t){var r=new Map;Object.keys(t).forEach(function(e){r.set(e,t[e]);r[e]=t[e]});return r};var a={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"};var o=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(t,n,r){return o.apply(this,[t||null]).then(function(r){if(c.version<48){r=i(r)}if(c.version<53&&!n){try{r.forEach(function(e){e.type=a[e.type]||e.type})}catch(e){if(e.name!=="TypeError"){throw e}r.forEach(function(e,t){r.set(t,Object.assign({},e,{type:a[e.type]||e.type}))})}}return r}).then(n,r)}},shimSenderGetStats:function(e){if(!(typeof e==="object"&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype){return}var r=e.RTCPeerConnection.prototype.getSenders;if(r){e.RTCPeerConnection.prototype.getSenders=function(){var t=this;var e=r.apply(t,[]);e.forEach(function(e){e._pc=t});return e}}var t=e.RTCPeerConnection.prototype.addTrack;if(t){e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);e._pc=this;return e}}e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},shimReceiverGetStats:function(e){if(!(typeof e==="object"&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype){return}var r=e.RTCPeerConnection.prototype.getReceivers;if(r){e.RTCPeerConnection.prototype.getReceivers=function(){var t=this;var e=r.apply(t,[]);e.forEach(function(e){e._pc=t});return e}}d.wrapPeerConnectionEvent(e,"track",function(e){e.receiver._pc=e.srcElement;return e});e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},shimRemoveStream:function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype){return}e.RTCPeerConnection.prototype.removeStream=function(t){var r=this;d.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(e){if(e.track&&t.getTracks().indexOf(e.track)!==-1){r.removeTrack(e)}})}},shimRTCDataChannel:function(e){if(e.DataChannel&&!e.RTCDataChannel){e.RTCDataChannel=e.DataChannel}},shimGetDisplayMedia:function(e,r){if("getDisplayMedia"in e.navigator){return}navigator.getDisplayMedia=function(e){if(!(e&&e.video)){var t=new DOMException("getDisplayMedia without video "+"constraints is undefined");t.name="NotFoundError";t.code=8;return Promise.reject(t)}if(e.video===true){e.video={mediaSource:r}}else{e.video.mediaSource=r}return navigator.mediaDevices.getUserMedia(e)}}}},{"../utils":14,"./getusermedia":12}],12:[function(e,t,r){"use strict";var l=e("../utils");var v=l.log;t.exports=function(e){var i=l.detectBrowser(e);var a=e&&e.navigator;var t=e&&e.MediaStreamTrack;var o=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the "+"user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}};var n=function(e,t,r){var n=function(n){if(typeof n!=="object"||n.require){return n}var i=[];Object.keys(n).forEach(function(e){if(e==="require"||e==="advanced"||e==="mediaSource"){return}var t=n[e]=typeof n[e]==="object"?n[e]:{ideal:n[e]};if(t.min!==undefined||t.max!==undefined||t.exact!==undefined){i.push(e)}if(t.exact!==undefined){if(typeof t.exact==="number"){t.min=t.max=t.exact}else{n[e]=t.exact}delete t.exact}if(t.ideal!==undefined){n.advanced=n.advanced||[];var r={};if(typeof t.ideal==="number"){r[e]={min:t.ideal,max:t.ideal}}else{r[e]=t.ideal}n.advanced.push(r);delete t.ideal;if(!Object.keys(t).length){delete n[e]}}});if(i.length){n.require=i}return n};e=JSON.parse(JSON.stringify(e));if(i.version<38){v("spec: "+JSON.stringify(e));if(e.audio){e.audio=n(e.audio)}if(e.video){e.video=n(e.video)}v("ff37: "+JSON.stringify(e))}return a.mozGetUserMedia(e,t,function(e){r(o(e))})};var r=function(r){return new Promise(function(e,t){n(r,e,t)})};if(!a.mediaDevices){a.mediaDevices={getUserMedia:r,addEventListener:function(){},removeEventListener:function(){}}}a.mediaDevices.enumerateDevices=a.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})};if(i.version<41){var s=a.mediaDevices.enumerateDevices.bind(a.mediaDevices);a.mediaDevices.enumerateDevices=function(){return s().then(undefined,function(e){if(e.name==="NotFoundError"){return[]}throw e})}}if(i.version<49){var c=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(t){return c(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length){e.getTracks().forEach(function(e){e.stop()});throw new DOMException("The object can not be found here.","NotFoundError")}return e},function(e){return Promise.reject(o(e))})}}if(!(i.version>55&&"autoGainControl"in a.mediaDevices.getSupportedConstraints())){var d=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}};var p=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(e){if(typeof e==="object"&&typeof e.audio==="object"){e=JSON.parse(JSON.stringify(e));d(e.audio,"autoGainControl","mozAutoGainControl");d(e.audio,"noiseSuppression","mozNoiseSuppression")}return p(e)};if(t&&t.prototype.getSettings){var f=t.prototype.getSettings;t.prototype.getSettings=function(){var e=f.apply(this,arguments);d(e,"mozAutoGainControl","autoGainControl");d(e,"mozNoiseSuppression","noiseSuppression");return e}}if(t&&t.prototype.applyConstraints){var u=t.prototype.applyConstraints;t.prototype.applyConstraints=function(e){if(this.kind==="audio"&&typeof e==="object"){e=JSON.parse(JSON.stringify(e));d(e,"autoGainControl","mozAutoGainControl");d(e,"noiseSuppression","mozNoiseSuppression")}return u.apply(this,[e])}}}a.getUserMedia=function(e,t,r){if(i.version<44){return n(e,t,r)}l.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");a.mediaDevices.getUserMedia(e).then(t,r)}}},{"../utils":14}],13:[function(e,t,r){"use strict";var o=e("../utils");t.exports={shimLocalStreamsAPI:function(e){if(typeof e!=="object"||!e.RTCPeerConnection){return}if(!("getLocalStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getLocalStreams=function(){if(!this._localStreams){this._localStreams=[]}return this._localStreams}}if(!("getStreamById"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getStreamById=function(t){var r=null;if(this._localStreams){this._localStreams.forEach(function(e){if(e.id===t){r=e}})}if(this._remoteStreams){this._remoteStreams.forEach(function(e){if(e.id===t){r=e}})}return r}}if(!("addStream"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(t){if(!this._localStreams){this._localStreams=[]}if(this._localStreams.indexOf(t)===-1){this._localStreams.push(t)}var r=this;t.getTracks().forEach(function(e){n.call(r,e,t)})};e.RTCPeerConnection.prototype.addTrack=function(e,t){if(t){if(!this._localStreams){this._localStreams=[t]}else if(this._localStreams.indexOf(t)===-1){this._localStreams.push(t)}}return n.call(this,e,t)}}if(!("removeStream"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.removeStream=function(e){if(!this._localStreams){this._localStreams=[]}var t=this._localStreams.indexOf(e);if(t===-1){return}this._localStreams.splice(t,1);var r=this;var n=e.getTracks();this.getSenders().forEach(function(e){if(n.indexOf(e.track)!==-1){r.removeTrack(e)}})}}},shimRemoteStreamsAPI:function(e){if(typeof e!=="object"||!e.RTCPeerConnection){return}if(!("getRemoteStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}}if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){if(this._onaddstream){this.removeEventListener("addstream",this._onaddstream)}this.addEventListener("addstream",this._onaddstream=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;if(!this._onaddstreampoly){this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(!r._remoteStreams){r._remoteStreams=[]}if(r._remoteStreams.indexOf(e)>=0){return}r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e;r.dispatchEvent(t)})})}return t.apply(r,arguments)}}},shimCallbacksAPI:function(e){if(typeof e!=="object"||!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype;var i=t.createOffer;var a=t.createAnswer;var o=t.setLocalDescription;var s=t.setRemoteDescription;var c=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0];var n=i.apply(this,[r]);if(!t){return n}n.then(e,t);return Promise.resolve()};t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0];var n=a.apply(this,[r]);if(!t){return n}n.then(e,t);return Promise.resolve()};var r=function(e,t,r){var n=o.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.setLocalDescription=r;r=function(e,t,r){var n=s.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.setRemoteDescription=r;r=function(e,t,r){var n=c.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.addIceCandidate=r},shimGetUserMedia:function(e){var n=e&&e.navigator;if(!n.getUserMedia){if(n.webkitGetUserMedia){n.getUserMedia=n.webkitGetUserMedia.bind(n)}else if(n.mediaDevices&&n.mediaDevices.getUserMedia){n.getUserMedia=function(e,t,r){n.mediaDevices.getUserMedia(e).then(t,r)}.bind(n)}}},shimRTCIceServerUrls:function(e){var a=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){var r=[];for(var n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];if(!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")){o.deprecated("RTCIceServer.url","RTCIceServer.urls");i=JSON.parse(JSON.stringify(i));i.urls=i.url;delete i.url;r.push(i)}else{r.push(e.iceServers[n])}}e.iceServers=r}return new a(e,t)};e.RTCPeerConnection.prototype=a.prototype;if("generateCertificate"in e.RTCPeerConnection){Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})}},shimTrackEventTransceiver:function(e){if(typeof e==="object"&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}},shimCreateOfferLegacy:function(e){var i=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var t=this;if(e){if(typeof e.offerToReceiveAudio!=="undefined"){e.offerToReceiveAudio=!!e.offerToReceiveAudio}var r=t.getTransceivers().find(function(e){return e.sender.track&&e.sender.track.kind==="audio"});if(e.offerToReceiveAudio===false&&r){if(r.direction==="sendrecv"){if(r.setDirection){r.setDirection("sendonly")}else{r.direction="sendonly"}}else if(r.direction==="recvonly"){if(r.setDirection){r.setDirection("inactive")}else{r.direction="inactive"}}}else if(e.offerToReceiveAudio===true&&!r){t.addTransceiver("audio")}if(typeof e.offerToReceiveVideo!=="undefined"){e.offerToReceiveVideo=!!e.offerToReceiveVideo}var n=t.getTransceivers().find(function(e){return e.sender.track&&e.sender.track.kind==="video"});if(e.offerToReceiveVideo===false&&n){if(n.direction==="sendrecv"){n.setDirection("sendonly")}else if(n.direction==="recvonly"){n.setDirection("inactive")}}else if(e.offerToReceiveVideo===true&&!n){t.addTransceiver("video")}}return i.apply(t,arguments)}}}},{"../utils":14}],14:[function(e,t,r){"use strict";var n=true;var i=true;function extractVersion(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function wrapPeerConnectionEvent(e,n,i){if(!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype;var a=t.addEventListener;t.addEventListener=function(e,r){if(e!==n){return a.apply(this,arguments)}var t=function(e){var t=i(e);if(t){r(t)}};this._eventMap=this._eventMap||{};this._eventMap[r]=t;return a.apply(this,[e,t])};var o=t.removeEventListener;t.removeEventListener=function(e,t){if(e!==n||!this._eventMap||!this._eventMap[t]){return o.apply(this,arguments)}var r=this._eventMap[t];delete this._eventMap[t];return o.apply(this,[e,r])};Object.defineProperty(t,"on"+n,{get:function(){return this["_on"+n]},set:function(e){if(this["_on"+n]){this.removeEventListener(n,this["_on"+n]);delete this["_on"+n]}if(e){this.addEventListener(n,this["_on"+n]=e)}},enumerable:true,configurable:true})}t.exports={extractVersion:extractVersion,wrapPeerConnectionEvent:wrapPeerConnectionEvent,disableLog:function(e){if(typeof e!=="boolean"){return new Error("Argument type: "+typeof e+". Please use a boolean.")}n=e;return e?"adapter.js logging disabled":"adapter.js logging enabled"},disableWarnings:function(e){if(typeof e!=="boolean"){return new Error("Argument type: "+typeof e+". Please use a boolean.")}i=!e;return"adapter.js deprecation warnings "+(e?"disabled":"enabled")},log:function(){if(typeof window==="object"){if(n){return}if(typeof console!=="undefined"&&typeof console.log==="function"){console.log.apply(console,arguments)}}},deprecated:function(e,t){if(!i){return}console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator;var r={};r.browser=null;r.version=null;if(typeof e==="undefined"||!e.navigator){r.browser="Not a browser.";return r}if(t.mozGetUserMedia){r.browser="firefox";r.version=extractVersion(t.userAgent,/Firefox\/(\d+)\./,1)}else if(t.webkitGetUserMedia){r.browser="chrome";r.version=extractVersion(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)}else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/)){r.browser="edge";r.version=extractVersion(t.userAgent,/Edge\/(\d+).(\d+)$/,2)}else if(e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)){r.browser="safari";r.version=extractVersion(t.userAgent,/AppleWebKit\/(\d+)\./,1)}else{r.browser="Not a supported browser.";return r}return r}}},{}]},{},[3])(3)});

    </script>
  </head>
  <body>
    <noscript>
      <strong>We're sorry but ION Call doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
</html>
